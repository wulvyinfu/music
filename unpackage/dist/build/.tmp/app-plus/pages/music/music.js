(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/music/music"],{"4e61":function(t,i,e){},5280:function(t,i,e){"use strict";e.r(i);var a=e("d79a"),n=e("8dab");for(var s in n)"default"!==s&&function(t){e.d(i,t,function(){return n[t]})}(s);e("63ce");var o=e("2877"),c=Object(o["a"])(n["default"],a["a"],a["b"],!1,null,null,null);i["default"]=c.exports},"63ce":function(t,i,e){"use strict";var a=e("4e61"),n=e.n(a);n.a},"8dab":function(t,i,e){"use strict";e.r(i);var a=e("ffc1"),n=e.n(a);for(var s in a)"default"!==s&&function(t){e.d(i,t,function(){return a[t]})}(s);i["default"]=n.a},d0e8:function(t,i,e){"use strict";e("afac");var a=s(e("b0ce")),n=s(e("5280"));function s(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(n.default))},d79a:function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("view",{attrs:{id:"page"}},[e("view",{staticClass:"img-body"},[e("image",{class:t.paused?"img":"img run",attrs:{src:t.detail.songs[0].al.picUrl}})]),e("view",[e("view",{staticClass:"lyricbody"},[e("ul",{style:"margin-top:"+-32*t.index+"px"},t._l(t.aLrc,function(i,a){return e("li",{class:t.index==a?"red":"",staticStyle:{"vertical-align":"middle"}},[t._v(t._s(i.lyric)),e("b",{staticStyle:{width:"4rpx",height:"45rpx",display:"inline-block"}})],1)}))],1),e("view",{staticClass:"icon-ab"},[e("view",{staticClass:"icon"},[e("cmd-icon",{attrs:{type:t.tolike?"heart-2":"heart",size:"20",color:"#666",eventid:"78ce56db-0",mpcomid:"78ce56db-0"},on:{click:t.toLike}})],1),e("view",{staticClass:"icon"},[e("cmd-icon",{attrs:{type:t.totar?"star-2":"star",size:"20",color:"#666",eventid:"78ce56db-1",mpcomid:"78ce56db-1"},on:{click:t.tostar}})],1),e("view",{staticClass:"icon"},[e("cmd-icon",{attrs:{type:"download",size:"20",color:"#666",eventid:"78ce56db-2",mpcomid:"78ce56db-2"},on:{click:t.download}})],1),e("view",{staticClass:"icon"},[e("uni-icon",{attrs:{type:"chatbubble",size:"28",color:"#666",eventid:"78ce56db-3",mpcomid:"78ce56db-3"},on:{click:t.tocomment}})],1),e("view",{staticClass:"icon"},[e("cmd-icon",{attrs:{type:"share",size:"20",color:"#666",mpcomid:"78ce56db-4"}})],1)]),e("view",{staticClass:"slideree"},[t._v(t._s(t.start)),e("slider",{attrs:{value:t.value,"block-size":"12",backgroundColor:"#888888",eventid:"78ce56db-4"},on:{change:t.change,changing:t.changing}}),t._v(t._s(t.total))])]),e("view",{staticClass:"icon-bar"},[e("view",{staticClass:"icon",attrs:{eventid:"78ce56db-5"},on:{click:t.toggleModul}},[3===t.mode?e("cmd-icon",{staticStyle:{"line-height":"1.8"},attrs:{type:"shuffle-play",size:"26",color:"#654321",mpcomid:"78ce56db-6"}}):e("uni-icon",{staticClass:"uni-icon",staticStyle:{"line-height":"1.8","font-weight":"bold"},attrs:{color:"#654321",size:"26",type:2===t.mode?"loop":"reload",mpcomid:"78ce56db-5"}})],1),e("view",{staticClass:"icon",attrs:{eventid:"78ce56db-6"},on:{click:t.preSong}},[e("cmd-icon",{staticStyle:{"line-height":"1.8"},attrs:{type:"prev",size:"26",color:"#654321",mpcomid:"78ce56db-7"}})],1),e("view",{staticClass:"icon",attrs:{eventid:"78ce56db-7"},on:{click:function(i){i.stopPropagation(),t.paused?t.play():t.pause()}}},[e("cmd-icon",{staticStyle:{"line-height":"1.8"},attrs:{type:t.paused?"play":"pause",size:"26",color:"#654321",mpcomid:"78ce56db-8"}})],1),e("view",{staticClass:"icon",attrs:{eventid:"78ce56db-8"},on:{click:function(i){i.stopPropagation(),t.nextSong(i)}}},[e("cmd-icon",{staticStyle:{"line-height":"1.8"},attrs:{type:"next",size:"26",color:"#654321",mpcomid:"78ce56db-9"}})],1),e("view",{staticClass:"icon"},[e("cmd-icon",{staticStyle:{"line-height":"1.8"},attrs:{type:"menu",size:"26",color:"#654321",eventid:"78ce56db-9",mpcomid:"78ce56db-10"},on:{click:t.togglState}})],1)]),e("uni-drawer",{attrs:{visible:t.showStar,mode:"right",eventid:"78ce56db-11",mpcomid:"78ce56db-13"},on:{close:t.closeDra}},[e("view",{staticStyle:{padding:"30rpx"}},[e("view",{staticClass:"uni-title"},[t._v("我的收藏")]),e("uni-list",{attrs:{mpcomid:"78ce56db-12"}},t._l(t.aStar,function(i,a){return e("uni-list-item",{key:a,attrs:{title:i.detail.songs[0].name,"show-arrow":"false",eventid:"78ce56db-10-"+a,mpcomid:"78ce56db-11-"+a},on:{click:function(e){t.startPlay(i,a)}}})}))],1)])],1)},n=[];e.d(i,"a",function(){return a}),e.d(i,"b",function(){return n})},ffc1:function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=d(e("2f62")),n=d(e("3dda")),s=d(e("4ace")),o=d(e("e446")),c=d(e("2cd3")),r=d(e("1473")),l=d(e("28b0"));function d(t){return t&&t.__esModule?t:{default:t}}function u(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{},a=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.forEach(function(i){h(t,i,e[i])})}return t}function h(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var g={components:{uniTag:n.default,cmdIcon:s.default,uniIcon:o.default,uniList:r.default,uniListItem:l.default,uniDrawer:c.default},computed:u({},a.default.mapState(["detail","paused","audio","lrc","history","num","mode","aLike","aStar","currentSrc","totar","tolike","playList"])),data:function(){return{start:"",total:"",value:0,updatestate:!0,aLrc:[],index:-1,moveState:!1,star:!1,heart:!1,showStar:!1,scroll:!1,timeout:{},Inter:{}}},mounted:function(){var i=this;this.update(),this.audio.onPlay(function(){i.update()}),t.setNavigationBarTitle({title:this.detail.songs[0].name}),this.audio.onTimeUpdate(this.jindu)},methods:u({},a.default.mapMutations(["play","pause","getdetail","getlrc","setsrc","next","pre","toggleModul","getstar","getlike","isstar","islike","restar","relike","changeList"]),a.default.mapActions(["getsrc"]),{tostar:function(){this.totar?this.restar():this.getstar(),this.isstar()},update:function(){this.lrcData(),t.setNavigationBarTitle({title:this.detail.songs[0].name}),this.isstar(),this.islike(),this.updateMic(),console.log(this.index)},init:function(i){var e=this;t.request({url:"http://www.302gzs.top:3555/lyric?id=".concat(i.id),success:function(t){var i=e;Promise.all([new Promise(function(e,a){i.getlrc(t.data.lrc.lyric)})]).then(function(){i.lrcData(),i.index=-1,i.updateMic()})}}),t.request({url:"http://www.302gzs.top:3555/song/detail?ids=".concat(i.id),success:function(i){e.getdetail(i.data),t.setNavigationBarTitle({title:e.detail.songs[0].name})}})},toLike:function(){alert("添加成功"),this.tolike?this.relike():this.getlike(),this.islike()},tocomment:function(){t.navigateTo({url:"/pages/comment/comment"})},download:function(){var i=this;t.downloadFile({url:this.audio.src,success:function(e){if(console.log(t.saveFile),t.saveFile)t.saveFile({tempFilePath:e.tempFilePath});else{var a=document.createElement("a");a.href=e.tempFilePath,a.download=i.detail.songs[0].name+".mp3",a.click()}}})},startPlay:function(t,i){this.playList=this.aStar,this.num=i,this.getsrc(t.detail.songs[0])},nextSong:function(){this.next(),this.toggleSong()},toggleHeart:function(){},preSong:function(){this.pre(),this.toggleSong()},toggleSong:function(){var i=this,e=this.playList[this.num];e.detail?(this.getlrc(e.lrc),this.getdetail(e.detail),this.setsrc(e.src),e=this.playList[this.num].detail.songs[0]):(t.request({url:"http://www.302gzs.top:3555/song/url?id=".concat(e.id),success:function(t){i.setsrc(t.data.data[0].url),console.log("ok")}}),this.init(e)),this.pause(),this.play()},change:function(t){var i=t.detail.value*this.audio.duration/100;this.audio.seek(i),this.updatestate=!0,this.updateMic()},changing:function(){this.updatestate=!1},updateMic:function(){var t=this,i=Math.floor(this.audio.currentTime/60);i=1===i.toString().length?"0"+i:i;var e=Math.round(this.audio.currentTime%60);e=1===e.toString().length?"0"+e:e;var a=Math.floor(this.audio.duration/60);a=1===a.toString().length?"0"+a:a;var n=Math.round(this.audio.duration%60);function s(){t.index++,t.aLrc[t.index+1]&&t.start>t.aLrc[t.index+1].time&&s()}n=1===n.toString().length?"0"+n:n,t.start="".concat(i,":").concat(e),this.total="".concat(a,":").concat(n),this.index=0,s()},lrcData:function(){var t=this.lrc.split("\n");this.aLrc=[];for(var i=0,e=t.length;i<e;i++){for(var a={},n=t[i].substring(1,t[i].length).split("]"),s="",o=1;o<n.length;o++)s+=n[o];a.time=n[0],a.lyric=s,this.aLrc.push(a)}this.len=this.aLrc.length},jindu:function(){var t=Math.floor(this.audio.currentTime/60);t=1===t.toString().length?"0"+t:t;var i=Math.round(this.audio.currentTime%60);i=1===i.toString().length?"0"+i:i;var e=Math.floor(this.audio.duration/60);e=1===e.toString().length?"0"+e:e;var a=Math.round(this.audio.duration%60);a=1===a.toString().length?"0"+a:a,this.start="".concat(t,":").concat(i),this.total="".concat(e,":").concat(a),this.updatestate&&(this.value=this.audio.currentTime/this.audio.duration*100),this.index!==this.aLrc.length-1&&this.aLrc[this.index+1].time<this.start&&this.index++},togglState:function(){this.showStar=!0},closeDra:function(){this.showStar=!1}})};i.default=g}).call(this,e("6e42")["default"])}},[["d0e8","common/runtime","common/vendor"]]]);